{{ 'swiper-bundle.min.css' | asset_url | stylesheet_tag }}

{%- style -%}
  #ImageCenterSlider-{{ section.id }} {
    width: 100%;
    padding: {{ section.settings.section_padding_top | default: 80 }}px 0 {{ section.settings.section_padding_bottom | default: 80 }}px 0;
    position: relative;
  }

  #ImageCenterSlider-{{ section.id }} .slider-container {
    width: 90%;
    margin: 0 auto;
  }

  #ImageCenterSlider-{{ section.id }} .slider-title {
    font-family: Inter, sans-serif;
    font-weight: 700;
    font-style: normal;
    font-size: 64px;
    line-height: 100%;
    letter-spacing: 0%;
    color: #000;
    margin: 0 0 60px 0;
    text-align: left;
  }

  #ImageCenterSlider-{{ section.id }} .slider-wrapper {
    position: relative;
    overflow: hidden;
  }

  #ImageCenterSlider-{{ section.id }} .swiper {
    width: 100%;
    height: auto;
    overflow: visible;
  }

  #ImageCenterSlider-{{ section.id }} .swiper-slide {
    height: auto;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0.7;
    transition: all 0.3s ease;
    width: 15% !important; /* 左右两边的图片宽度 */
  }

  #ImageCenterSlider-{{ section.id }} .swiper-slide-active {
    opacity: 1;
    width: 70% !important; /* 中间激活图片的宽度 */
  }

  #ImageCenterSlider-{{ section.id }} .slider-image {
    width: 100%;
    object-fit: cover;
    border-radius: 20px;
    display: block;
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 60px;
    height: 60px;
    background: rgba(255, 255, 255, 0.5);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: all 0.3s ease;
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-button:hover:not(.swiper-button-disabled) {
    background: rgba(255, 255, 255, 0.8);
    transform: translateY(-50%) scale(1.1);
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-button.swiper-button-disabled {
    background: rgba(255, 255, 255, 0.2);
    cursor: not-allowed;
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-button.swiper-button-disabled .slider-nav-icon {
    fill: rgba(236, 100, 44, 0.3);
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-prev {
    left: 40px;
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-next {
    right: 40px;
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-icon {
    width: 24px;
    height: 24px;
    fill: rgba(236, 100, 44, 0.8);
    transition: fill 0.3s ease;
  }

  #ImageCenterSlider-{{ section.id }} .slider-nav-button:hover:not(.swiper-button-disabled) .slider-nav-icon {
    fill: #EC642C;
  }

  @media screen and (max-width: 1199px) {
    #ImageCenterSlider-{{ section.id }} .slider-title {
      font-size: 56px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-image {
      height: 420px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-button {
      width: 50px;
      height: 50px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-prev {
      left: 30px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-next {
      right: 30px;
    }
  }

  @media screen and (max-width: 899px) {
    #ImageCenterSlider-{{ section.id }} .slider-title {
      font-size: 48px;
      margin-bottom: 30px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-image {
      height: 350px;
    }

    #ImageCenterSlider-{{ section.id }} .swiper-slide {
      width: 40% !important;
    }

    #ImageCenterSlider-{{ section.id }} .swiper-slide-active {
      width: 60% !important;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-prev {
      left: 20px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-next {
      right: 20px;
    }
  }

  @media screen and (max-width: 599px) {
    #ImageCenterSlider-{{ section.id }} .slider-title {
      font-size: 36px;
      margin-bottom: 24px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-image {
      height: 280px;
      border-radius: 15px;
    }

    #ImageCenterSlider-{{ section.id }} .swiper-slide {
      width: 90% !important;
    }

    #ImageCenterSlider-{{ section.id }} .swiper-slide-active {
      width: 90% !important;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-button {
      width: 40px;
      height: 40px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-icon {
      width: 20px;
      height: 20px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-prev {
      left: 15px;
    }

    #ImageCenterSlider-{{ section.id }} .slider-nav-next {
      right: 15px;
    }
  }
{%- endstyle -%}

<div id="ImageCenterSlider-{{ section.id }}" class="section">
  <div class="slider-container">
    {%- if section.settings.title != blank -%}
      <h2 class="slider-title">{{ section.settings.title }}</h2>
    {%- endif -%}

    {%- if section.blocks.size > 0 -%}
      <div class="slider-wrapper">
        <div class="swiper mySlider-{{ section.id }}">
          <div class="swiper-wrapper">
            {%- for block in section.blocks -%}
              {%- if block.settings.image != blank -%}
                <div class="swiper-slide" {{ block.shopify_attributes }}>
                  <img
                    src="{{ block.settings.image | image_url: width: 1100 }}"
                    alt="{{ block.settings.image.alt | default: block.settings.title | default: 'Slider Image' }}"
                    class="slider-image"
                    width="1100"
                    height="600"
                    loading="lazy"
                  >
                </div>
              {%- endif -%}
            {%- endfor -%}
          </div>
        </div>

        {%- if section.blocks.size > 1 -%}
          <button class="slider-nav-button slider-nav-prev swiper-button-prev-{{ section.id }}">
            <svg class="slider-nav-icon" viewBox="0 0 24 24">
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
            </svg>
          </button>
          <button class="slider-nav-button slider-nav-next swiper-button-next-{{ section.id }}">
            <svg class="slider-nav-icon" viewBox="0 0 24 24">
              <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
            </svg>
          </button>
        {%- endif -%}
      </div>
    {%- endif -%}
  </div>
</div>

<script src="{{ 'swiper-bundle.min.js' | asset_url }}" defer></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // 确保 Swiper 已加载
    if (typeof Swiper !== 'undefined') {
      const swiperInstance = new Swiper('.mySlider-{{ section.id }}', {
        slidesPerView: 3,
        spaceBetween: 60,
        centeredSlides: true,
        loop: false,
        navigation: {
          nextEl: '.swiper-button-next-{{ section.id }}',
          prevEl: '.swiper-button-prev-{{ section.id }}',
        },
        breakpoints: {
          320: {
            slidesPerView: 1,
            spaceBetween: 0,
            centeredSlides: true,
          },
          768: {
            slidesPerView: 2,
            spaceBetween: 120,
            centeredSlides: true,
          },
          1024: {
            slidesPerView: 3,
            spaceBetween: 60,
            centeredSlides: true,
          },
        },
        on: {
          init: function () {
            console.log('Image Center Slider initialized for section {{ section.id }}');
          },
          error: function (error) {
            console.error('Swiper error:', error);
          },
        },
      });
    } else {
      console.error('Swiper is not loaded');
    }
  });
</script>

{% schema %}
{
  "name": "图片轮播 Image Center Slider",
  "tag": "section",
  "class": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "标题",
      "default": "Inspiring Moments"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "min": 0,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "顶部内边距",
      "default": 80
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "min": 0,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "底部内边距",
      "default": 80
    }
  ],
  "blocks": [
    {
      "type": "slide_item",
      "name": "轮播图片",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "轮播图片"
        },
        {
          "type": "text",
          "id": "title",
          "label": "图片标题（用于alt属性）"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "图片轮播 Image Center Slider",
      "settings": {
        "title": "Inspiring Moments"
      },
      "blocks": [
        {
          "type": "slide_item"
        },
        {
          "type": "slide_item"
        },
        {
          "type": "slide_item"
        }
      ]
    }
  ]
}
{% endschema %}
